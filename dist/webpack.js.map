{"version":3,"file":"webpack.js","sources":["../src/webpack.ts"],"sourcesContent":["import type { Compiler } from 'webpack';\nimport { resolve } from 'path';\n\nexport const virtualLoaderName = 'glimmer-scoped-css';\n\nexport class GlimmerScopedCSSWebpackPlugin {\n  private addLoaderAlias(compiler: Compiler, name: string, alias: string) {\n    let { resolveLoader } = compiler.options;\n    if (Array.isArray(resolveLoader.alias)) {\n      resolveLoader.alias.push({ name, alias });\n    } else if (resolveLoader.alias) {\n      resolveLoader.alias[name] = alias;\n    } else {\n      resolveLoader.alias = {\n        [name]: alias,\n      };\n    }\n  }\n\n  apply(compiler: Compiler) {\n    this.addLoaderAlias(\n      compiler,\n      virtualLoaderName,\n      resolve(__dirname, './virtual-loader')\n    );\n\n    // compiler.hooks.normalModuleFactory.tap('glimmer-scoped-css', (nmf) => {\n    //   nmf.hooks.resolve.tapAsync(\n    //     { name: 'glimmer-scoped-css', stage: 0 },\n    //     (state: unknown, callback: CB) => {\n    //       if (!isRelevantRequest(state)) {\n    //         callback(); // continue to delegate to other hooks\n    //         return;\n    //       }\n    //     }\n    //   );\n    // });\n  }\n}\n"],"names":["virtualLoaderName","GlimmerScopedCSSWebpackPlugin","addLoaderAlias","compiler","name","alias","resolveLoader","options","Array","isArray","push","apply","resolve","__dirname"],"mappings":";;;;;;AAGO,MAAMA,iBAAiB,GAAG,qBAAoB;AAE9C,MAAMC,6BAA6B,CAAC;AACjCC,EAAAA,cAAcA,CAACC,QAAkB,EAAEC,IAAY,EAAEC,KAAa,EAAE;IACtE,IAAI;AAAEC,MAAAA,aAAAA;KAAe,GAAGH,QAAQ,CAACI,OAAO,CAAA;IACxC,IAAIC,KAAK,CAACC,OAAO,CAACH,aAAa,CAACD,KAAK,CAAC,EAAE;AACtCC,MAAAA,aAAa,CAACD,KAAK,CAACK,IAAI,CAAC;QAAEN,IAAI;AAAEC,QAAAA,KAAAA;AAAM,OAAC,CAAC,CAAA;AAC3C,KAAC,MAAM,IAAIC,aAAa,CAACD,KAAK,EAAE;AAC9BC,MAAAA,aAAa,CAACD,KAAK,CAACD,IAAI,CAAC,GAAGC,KAAK,CAAA;AACnC,KAAC,MAAM;MACLC,aAAa,CAACD,KAAK,GAAG;AACpB,QAAA,CAACD,IAAI,GAAGC,KAAAA;OACT,CAAA;AACH,KAAA;AACF,GAAA;EAEAM,KAAKA,CAACR,QAAkB,EAAE;AACxB,IAAA,IAAI,CAACD,cAAc,CACjBC,QAAQ,EACRH,iBAAiB,EACjBY,YAAO,CAACC,SAAS,EAAE,kBAAkB,CAAC,CACvC,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACF,GAAA;AACF;;;;;"}